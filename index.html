<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
<title>LiLyrics v2.4 Aura - Simplified Edition</title>
<style>
:root {
  --primary-color: #4285f4;
  --secondary-color: #34a853;
  --error-color: #ea4335;
  --background-color: #fafafa;
  --surface-color: #ffffff;
  --text-primary: #202124;
  --text-secondary: #5f6368;
  --border-color: #dadce0;
  --shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
}

body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: var(--background-color);
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.dark {
  --background-color: #121212;
  --surface-color: #1e1e1e;
  --text-primary: #e0e0e0;
  --text-secondary: #aaa;
  --border-color: #333;
}

header {
  padding: 20px;
  text-align: center;
  background: var(--surface-color);
  border-bottom: 1px solid var(--border-color);
  position: relative;
  box-shadow: var(--shadow);
}

.logo {
  font-weight: bold;
  font-size: 32px;
  color: var(--primary-color);
  margin-bottom: 8px;
}

.tagline {
  font-size: 14px;
  color: var(--text-secondary);
}

#themeToggle {
  position: absolute;
  right: 15px;
  top: 15px;
  cursor: pointer;
  font-size: 20px;
  color: var(--primary-color);
  background: none;
  border: none;
  padding: 8px;
  border-radius: 50%;
  transition: all 0.2s ease;
}

#themeToggle:hover {
  background: rgba(66, 133, 244, 0.1);
}

#tabs-container {
  display: flex;
  background: var(--surface-color);
  border-bottom: 2px solid var(--primary-color);
  overflow-x: auto;
  box-shadow: var(--shadow);
}

#tabs {
  display: flex;
  flex: 1;
}

.tab {
  padding: 12px 16px;
  cursor: pointer;
  user-select: none;
  flex-shrink: 0;
  min-width: 100px;
  max-width: 200px;
  border-bottom: 3px solid transparent;
  color: var(--text-secondary);
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 8px;
  position: relative;
}

.tab:hover {
  background: rgba(66, 133, 244, 0.05);
}

.tab.active {
  border-bottom-color: var(--primary-color);
  font-weight: 600;
  color: var(--primary-color);
  background: rgba(66, 133, 244, 0.05);
}

.tab-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.tab .close-btn {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: rgba(234, 67, 53, 0.1);
  color: var(--error-color);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;
}

.tab .close-btn:hover {
  background: var(--error-color);
  color: white;
}

#addTab {
  padding: 12px 16px;
  cursor: pointer;
  color: var(--primary-color);
  font-weight: bold;
  user-select: none;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.2s;
}

#addTab:hover {
  background: rgba(66, 133, 244, 0.1);
}

#editor {
  width: 100%;
  height: 60vh;
  padding: 20px;
  font-size: 16px;
  font-family: 'Consolas', 'Monaco', monospace;
  border: none;
  resize: none;
  box-sizing: border-box;
  background: var(--surface-color);
  color: var(--text-primary);
  outline: none;
  line-height: 1.6;
}

#editor:focus {
  background: rgba(66, 133, 244, 0.02);
}

#controls {
  padding: 16px;
  background: var(--surface-color);
  border-top: 1px solid var(--border-color);
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  justify-content: center;
  box-shadow: var(--shadow);
}

button {
  background: var(--primary-color);
  border: none;
  padding: 10px 16px;
  color: white;
  cursor: pointer;
  border-radius: 6px;
  font-weight: 500;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
}

button:hover {
  background: var(--secondary-color);
  transform: translateY(-1px);
  box-shadow: var(--shadow);
}

button:active {
  transform: translateY(0);
}

#status {
  padding: 12px;
  text-align: center;
  color: var(--secondary-color);
  font-size: 14px;
  background: var(--surface-color);
  border-top: 1px solid var(--border-color);
}

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 60vh;
  background: var(--surface-color);
  color: var(--text-secondary);
  text-align: center;
  padding: 40px;
}

.empty-state i {
  font-size: 48px;
  color: var(--primary-color);
  margin-bottom: 16px;
}

.empty-state h3 {
  margin: 0 0 12px 0;
  color: var(--text-primary);
}

.empty-state p {
  margin: 0;
  max-width: 400px;
}

#newProjectBtn {
  background: var(--primary-color);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  margin-top: 20px;
  transition: all 0.2s;
}

#newProjectBtn:hover {
  background: var(--secondary-color);
  transform: translateY(-2px);
}

/* File input hidden */
input[type="file"] {
  display: none;
}

/* Rhyme suggestions area */
#rhyme-area {
  padding: 16px;
  background: var(--surface-color);
  border-top: 1px solid var(--border-color);
  min-height: 60px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

#rhyme-suggestions {
  flex: 1;
  color: var(--text-secondary);
}

#word-count {
  color: var(--primary-color);
  font-weight: 600;
  font-size: 14px;
}

@media (max-width: 768px) {
  .logo {
    font-size: 24px;
  }
  
  #controls {
    flex-direction: column;
    align-items: stretch;
  }
  
  .tab {
    min-width: 80px;
    max-width: 120px;
    font-size: 13px;
  }
  
  #editor {
    height: 50vh;
    font-size: 14px;
  }
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
<header>
  <div class="logo">LiLyrics v2.4 Aura</div>
  <div class="tagline">Simplified Songwriting Studio - Clean & Functional</div>
  <button id="themeToggle" title="Toggle Theme"><i class="fas fa-moon"></i></button>
</header>

<div id="tabs-container">
  <div id="tabs"></div>
  <div id="addTab" title="Add New Project">
    <i class="fas fa-plus"></i>
    <span>New</span>
  </div>
</div>

<div id="main-content">
  <textarea id="editor" placeholder="Start writing your lyrics here..."></textarea>
</div>

<div id="controls">
  <button id="saveBtn" title="Save Project">
    <i class="fas fa-save"></i> Save
  </button>
  <button id="loadBtn" title="Load File" onclick="document.getElementById('fileInput').click()">
    <i class="fas fa-folder-open"></i> Load
  </button>
  <button id="undoBtn" title="Undo">
    <i class="fas fa-undo"></i> Undo
  </button>
  <button id="redoBtn" title="Redo">
    <i class="fas fa-redo"></i> Redo
  </button>
  <button id="rhymeBtn" title="Find Rhymes">
    <i class="fas fa-search"></i> Rhymes
  </button>
  <button id="exportTxtBtn" title="Export as TXT">
    <i class="fas fa-download"></i> Export TXT
  </button>
  <button id="exportPdfBtn" title="Export as PDF">
    <i class="fas fa-file-pdf"></i> Export PDF
  </button>
</div>

<div id="rhyme-area">
  <div id="rhyme-suggestions">Ready to write amazing lyrics!</div>
  <div id="word-count">0 words</div>
</div>

<div id="status">Welcome to LiLyrics v2.4 Aura - Simplified Edition</div>

<input type="file" id="fileInput" accept=".txt,.json" />

<script>
// ===== LILYRICS v2.4 AURA - SIMPLIFIED & FULLY FUNCTIONAL =====

let projects = JSON.parse(localStorage.getItem('lyricProjects') || '{}');
let currentProject = null;
let undoStack = [];
let redoStack = [];
let untitledCounter = 1;

const tabsDiv = document.getElementById('tabs');
const editor = document.getElementById('editor');
const statusDiv = document.getElementById('status');
const themeToggle = document.getElementById('themeToggle');
const addTabBtn = document.getElementById('addTab');
const mainContent = document.getElementById('main-content');
const rhymeSuggestions = document.getElementById('rhyme-suggestions');
const wordCountDiv = document.getElementById('word-count');

// Basic rhyme dictionary
const simpleRhymes = {
  'love': ['dove', 'above', 'shove', 'glove', 'push', 'rush', 'crush'],
  'heart': ['start', 'part', 'art', 'smart', 'cart', 'dart'],
  'time': ['rhyme', 'climb', 'prime', 'chime', 'lime'],
  'night': ['light', 'right', 'sight', 'bright', 'fight', 'might'],
  'day': ['way', 'say', 'play', 'stay', 'pray', 'may'],
  'dream': ['stream', 'cream', 'beam', 'team', 'seem']
};

// Initialize app
function init() {
  loadTheme();
  renderTabs();
  updateWordCount();
  
  // Show welcome message if no projects
  if (Object.keys(projects).length === 0) {
    showEmptyState();
  }
}

function showEmptyState() {
  mainContent.innerHTML = `
    <div class="empty-state">
      <i class="fas fa-music"></i>
      <h3>Welcome to LiLyrics v2.4 Aura</h3>
      <p>Create your first project to start writing amazing lyrics!</p>
      <button id="newProjectBtn" onclick="createNewProject()">
        <i class="fas fa-plus"></i> Create New Project
      </button>
    </div>
  `;
}

function showEditor() {
  if (!document.getElementById('editor')) {
    mainContent.innerHTML = '<textarea id="editor" placeholder="Start writing your lyrics here..."></textarea>';
    const newEditor = document.getElementById('editor');
    newEditor.oninput = handleEditorInput;
    return newEditor;
  }
  return document.getElementById('editor');
}

function handleEditorInput() {
  if (currentProject) {
    projects[currentProject] = editor.value;
    saveProjects();
    
    // Add to undo stack
    undoStack.push(editor.value);
    if (undoStack.length > 50) undoStack.shift();
    redoStack = [];
    
    updateWordCount();
    statusDiv.textContent = `Editing: ${currentProject}`;
  }
}

function saveProjects() {
  localStorage.setItem('lyricProjects', JSON.stringify(projects));
}

function updateWordCount() {
  const text = editor ? editor.value : '';
  const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
  wordCountDiv.textContent = `${words} words`;
}

function renderTabs() {
  tabsDiv.innerHTML = '';
  
  if (Object.keys(projects).length === 0) {
    currentProject = null;
    showEmptyState();
    return;
  }
  
  // Ensure editor exists
  const editorElement = showEditor();
  
  Object.keys(projects).forEach(name => {
    const tab = document.createElement('div');
    tab.className = 'tab';
    if (name === currentProject) tab.classList.add('active');
    
    const tabName = document.createElement('div');
    tabName.className = 'tab-name';
    tabName.textContent = name;
    tabName.onclick = (e) => {
      e.stopPropagation();
      editTabName(name);
    };
    
    const closeBtn = document.createElement('div');
    closeBtn.className = 'close-btn';
    closeBtn.innerHTML = '×';
    closeBtn.onclick = (e) => {
      e.stopPropagation();
      closeTab(name);
    };
    
    tab.onclick = () => switchTab(name);
    tab.appendChild(tabName);
    tab.appendChild(closeBtn);
    tabsDiv.appendChild(tab);
  });
}

function switchTab(name) {
  if (currentProject && editor) {
    projects[currentProject] = editor.value;
  }
  
  currentProject = name;
  const editorElement = showEditor();
  editorElement.value = projects[name] || '';
  
  renderTabs();
  updateWordCount();
  statusDiv.textContent = `Editing: ${currentProject}`;
  clearUndoRedo();
  editorElement.focus();
}

function closeTab(name) {
  if (!confirm(`Close "${name}"?`)) return;
  
  delete projects[name];
  
  if (currentProject === name) {
    const remainingProjects = Object.keys(projects);
    if (remainingProjects.length > 0) {
      switchTab(remainingProjects[0]);
    } else {
      currentProject = null;
      showEmptyState();
    }
  }
  
  renderTabs();
  saveProjects();
}

function editTabName(oldName) {
  const newName = prompt('Enter new name:', oldName);
  if (!newName || newName === oldName || projects[newName]) return;
  
  projects[newName] = projects[oldName];
  delete projects[oldName];
  
  if (currentProject === oldName) {
    currentProject = newName;
  }
  
  renderTabs();
  saveProjects();
}

function createNewProject() {
  let name = `Untitled ${untitledCounter}`;
  while (projects[name]) {
    untitledCounter++;
    name = `Untitled ${untitledCounter}`;
  }
  
  projects[name] = '';
  currentProject = name;
  untitledCounter++;
  
  const editorElement = showEditor();
  editorElement.value = '';
  editorElement.oninput = handleEditorInput;
  
  renderTabs();
  saveProjects();
  clearUndoRedo();
  statusDiv.textContent = `Created: ${name}`;
  editorElement.focus();
}

function clearUndoRedo() {
  undoStack = [];
  redoStack = [];
  if (currentProject && editor) {
    undoStack.push(editor.value);
  }
}

// Event Listeners
addTabBtn.onclick = createNewProject;

document.getElementById('saveBtn').onclick = function() {
  if (!currentProject) {
    alert('No project to save!');
    return;
  }
  
  if (editor) {
    projects[currentProject] = editor.value;
    saveProjects();
    statusDiv.textContent = `Saved: ${currentProject}`;
  }
};

document.getElementById('fileInput').onchange = function(e) {
  const file = e.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function() {
    const name = file.name.replace(/\.(txt|json)$/, '');
    let content = reader.result;
    
    try {
      if (file.name.endsWith('.json')) {
        const data = JSON.parse(content);
        if (data.projects) {
          Object.assign(projects, data.projects);
          const firstProject = Object.keys(data.projects)[0];
          if (firstProject) {
            switchTab(firstProject);
          }
        } else {
          projects[name] = content;
          switchTab(name);
        }
      } else {
        projects[name] = content;
        switchTab(name);
      }
    } catch (error) {
      projects[name] = content;
      switchTab(name);
    }
    
    saveProjects();
    statusDiv.textContent = `Loaded: ${name}`;
  };
  reader.readAsText(file);
};

document.getElementById('undoBtn').onclick = function() {
  if (!editor || undoStack.length < 2) {
    statusDiv.textContent = 'Nothing to undo';
    return;
  }
  
  redoStack.push(undoStack.pop());
  const prev = undoStack[undoStack.length - 1] || '';
  editor.value = prev;
  
  if (currentProject) {
    projects[currentProject] = prev;
    saveProjects();
  }
  
  updateWordCount();
  statusDiv.textContent = 'Undo performed';
};

document.getElementById('redoBtn').onclick = function() {
  if (!editor || redoStack.length === 0) {
    statusDiv.textContent = 'Nothing to redo';
    return;
  }
  
  const next = redoStack.pop();
  undoStack.push(next);
  editor.value = next;
  
  if (currentProject) {
    projects[currentProject] = next;
    saveProjects();
  }
  
  updateWordCount();
  statusDiv.textContent = 'Redo performed';
};

document.getElementById('rhymeBtn').onclick = function() {
  if (!editor) {
    rhymeSuggestions.textContent = 'No editor available';
    return;
  }
  
  const word = prompt('Enter a word to find rhymes:');
  if (!word) return;
  
  const searchWord = word.toLowerCase().trim();
  const rhymes = simpleRhymes[searchWord] || [];
  
  if (rhymes.length > 0) {
    rhymeSuggestions.innerHTML = `<strong>Rhymes for "${word}":</strong> ${rhymes.join(', ')}`;
  } else {
    rhymeSuggestions.textContent = `No rhymes found for "${word}". Try: love, heart, time, night, day, dream`;
  }
  
  setTimeout(() => {
    rhymeSuggestions.textContent = 'Ready to write amazing lyrics!';
  }, 5000);
};

document.getElementById('exportTxtBtn').onclick = function() {
  if (!currentProject || !editor) {
    alert('No project to export!');
    return;
  }
  
  const blob = new Blob([editor.value], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = currentProject + '.txt';
  a.click();
  URL.revokeObjectURL(url);
  
  statusDiv.textContent = `Exported: ${currentProject}.txt`;
};

document.getElementById('exportPdfBtn').onclick = function() {
  if (!currentProject || !editor || !editor.value.trim()) {
    alert('No content to export!');
    return;
  }
  
  try {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const lines = doc.splitTextToSize(editor.value, 180);
    doc.text(lines, 10, 10);
    doc.save(currentProject + '.pdf');
    statusDiv.textContent = `Exported: ${currentProject}.pdf`;
  } catch (error) {
    alert('PDF export not available. Use TXT export instead.');
  }
};

themeToggle.onclick = function() {
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  
  themeToggle.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
  
  statusDiv.textContent = `Switched to ${isDark ? 'dark' : 'light'} theme`;
};

function loadTheme() {
  const theme = localStorage.getItem('theme');
  if (theme === 'dark') {
    document.body.classList.add('dark');
    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
  }
}

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
  if (e.ctrlKey || e.metaKey) {
    switch(e.key.toLowerCase()) {
      case 's':
        e.preventDefault();
        document.getElementById('saveBtn').click();
        break;
      case 'n':
        e.preventDefault();
        createNewProject();
        break;
      case 'o':
        e.preventDefault();
        document.getElementById('fileInput').click();
        break;
      case 'z':
        e.preventDefault();
        document.getElementById('undoBtn').click();
        break;
      case 'y':
        e.preventDefault();
        document.getElementById('redoBtn').click();
        break;
    }
  }
});

// Initialize the app
init();
</script>
</body>
</html>
